<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Mapa Curricular - Engenharia de Software</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			background: #f5f5f5;
			min-height: 100vh;
			padding: 20px;
		}

		.header {
			text-align: center;
			margin-bottom: 30px;
			background: white;
			padding: 20px;
			border-radius: 10px;
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
		}

		.header h1 {
			color: #333;
			margin-bottom: 10px;
			font-size: 2.5em;
		}

		.nav-link {
			display: inline-block;
			color: #666;
			text-decoration: none;
			background: #f0f0f0;
			padding: 10px 20px;
			border-radius: 25px;
			margin-bottom: 20px;
			transition: all 0.3s ease;
		}

		.nav-link:hover {
			background: #e0e0e0;
			transform: translateY(-2px);
		}

		.mapa-container {
			position: relative;
			max-width: 1600px;
			margin: 0 auto;
			background: white;
			border-radius: 15px;
			padding: 40px;
			box-shadow: 0 4px 20px rgba(0,0,0,0.1);
			overflow: hidden;
		}

		.periodos-container {
			display: flex;
			gap: 30px;
			min-height: 800px;
			position: relative;
		}

		.periodo {
			flex: 1;
			min-width: 150px;
		}

		.periodo h3 {
			text-align: center;
			margin-bottom: 20px;
			font-size: 1.1em;
			color: #333;
			background: #f8f9fa;
			padding: 10px;
			border-radius: 8px;
			border: 2px solid #dee2e6;
		}

		.materia {
			background: #6c757d; /* Cinza escuro por padrão */
			border: 2px solid #495057;
			border-radius: 8px;
			padding: 12px 8px;
			margin: 15px 0;
			cursor: pointer;
			transition: all 0.3s ease;
			position: relative;
			color: white;
			text-align: center;
			font-weight: bold;
			font-size: 0.85em;
			min-height: 60px;
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 10;
		}

		/* Estados das matérias */
		.materia.indisponivel {
			background: #6c757d;
			border-color: #495057;
			color: #adb5bd;
			cursor: not-allowed;
		}

		.materia.disponivel {
			background: #adb5bd;
			border-color: #868e96;
			color: #495057;
		}

		.materia.cursada {
			background: #a8dadc;
			border-color: #457b9d;
			color: #1d3557;
		}

		.materia.avaliada {
			background: #52c41a;
			border-color: #389e0d;
			color: white;
		}

		.materia:hover:not(.indisponivel) {
			transform: translateY(-2px) scale(1.02);
			box-shadow: 0 4px 15px rgba(0,0,0,0.2);
		}

		/* Linhas de conexão */
		.connection-line {
			position: absolute;
			background: #007bff;
			z-index: 1;
			opacity: 0.7;
		}

		.connection-line.horizontal {
			height: 2px;
		}

		.connection-line.vertical {
			width: 2px;
		}

		.connection-arrow {
			position: absolute;
			width: 0;
			height: 0;
			border-left: 6px solid transparent;
			border-right: 6px solid transparent;
			border-top: 8px solid #007bff;
			z-index: 2;
		}

		.legenda {
			position: fixed;
			top: 20px;
			right: 20px;
			background: white;
			padding: 20px;
			border-radius: 10px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
			font-size: 0.9em;
			border: 1px solid #dee2e6;
		}

		.legenda h4 {
			margin-bottom: 15px;
			color: #333;
		}

		.legenda-item {
			display: flex;
			align-items: center;
			margin: 8px 0;
			font-size: 0.85em;
		}

		.legenda-cor {
			width: 20px;
			height: 20px;
			border-radius: 4px;
			margin-right: 10px;
			border: 1px solid #ccc;
		}

		.controles {
			margin-bottom: 20px;
			text-align: center;
		}

		.controles button {
			background: #007bff;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 5px;
			margin: 0 5px;
			cursor: pointer;
			font-size: 0.9em;
			transition: background 0.3s ease;
		}

		.controles button:hover {
			background: #0056b3;
		}

		.info-materia {
			position: fixed;
			bottom: 20px;
			left: 20px;
			background: white;
			padding: 15px;
			border-radius: 10px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.1);
			border: 1px solid #dee2e6;
			max-width: 300px;
			display: none;
		}

		/* Modal Styles */
		.modal {
			display: none;
			position: fixed;
			z-index: 1000;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: rgba(0,0,0,0.5);
			backdrop-filter: blur(5px);
		}

		.modal-content {
			background-color: #fefefe;
			margin: 5% auto;
			padding: 0;
			border: none;
			border-radius: 15px;
			width: 90%;
			max-width: 600px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.3);
			animation: modalShow 0.3s ease-out;
		}

		@keyframes modalShow {
			from {
				opacity: 0;
				transform: translateY(-50px) scale(0.9);
			}
			to {
				opacity: 1;
				transform: translateY(0) scale(1);
			}
		}

		.modal-header {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
			padding: 20px;
			border-radius: 15px 15px 0 0;
			position: relative;
		}

		.modal-header h2 {
			margin: 0;
			font-size: 1.5em;
		}

		.modal-header .codigo {
			font-size: 0.9em;
			opacity: 0.9;
			margin-top: 5px;
		}

		.close {
			color: white;
			float: right;
			font-size: 28px;
			font-weight: bold;
			cursor: pointer;
			position: absolute;
			right: 20px;
			top: 15px;
			transition: opacity 0.3s ease;
		}

		.close:hover {
			opacity: 0.7;
		}

		.modal-body {
			padding: 25px;
		}

		.info-section {
			margin-bottom: 25px;
		}

		.info-section h3 {
			color: #333;
			margin-bottom: 10px;
			font-size: 1.1em;
			border-bottom: 2px solid #667eea;
			padding-bottom: 5px;
		}

		.info-section p, .info-section ul {
			color: #666;
			line-height: 1.6;
			margin-bottom: 10px;
		}

		.professor-card {
			background: #f8f9fa;
			border-radius: 8px;
			padding: 15px;
			margin: 10px 0;
			border-left: 4px solid #667eea;
		}

		.professor-card h4 {
			margin: 0 0 5px 0;
			color: #333;
		}

		.professor-card .contato {
			font-size: 0.9em;
			color: #666;
		}

		.status-section {
			background: #f8f9fa;
			border-radius: 10px;
			padding: 20px;
			margin-top: 20px;
		}

		.status-controls {
			display: flex;
			gap: 10px;
			margin-bottom: 15px;
			flex-wrap: wrap;
		}

		.status-btn {
			padding: 8px 16px;
			border: 2px solid #dee2e6;
			border-radius: 20px;
			background: white;
			cursor: pointer;
			transition: all 0.3s ease;
			font-size: 0.9em;
		}

		.status-btn.active {
			background: #667eea;
			color: white;
			border-color: #667eea;
		}

		.status-btn:hover {
			border-color: #667eea;
		}

		.avaliacao-container {
			margin-top: 15px;
			display: none;
		}

		.avaliacao-container.show {
			display: block;
		}

		.form-group {
			margin-bottom: 15px;
		}

		.form-group label {
			display: block;
			margin-bottom: 5px;
			font-weight: bold;
			color: #333;
		}

		.form-group input, .form-group textarea, .form-group select {
			width: 100%;
			padding: 10px;
			border: 2px solid #dee2e6;
			border-radius: 5px;
			font-size: 0.9em;
			transition: border-color 0.3s ease;
		}

		.form-group input:focus, .form-group textarea:focus, .form-group select:focus {
			outline: none;
			border-color: #667eea;
		}

		.form-group textarea {
			resize: vertical;
			min-height: 80px;
		}

		.nota-display {
			display: inline-block;
			background: #52c41a;
			color: white;
			padding: 5px 15px;
			border-radius: 15px;
			font-weight: bold;
			margin-left: 10px;
		}

		.comentarios-section {
			margin-top: 20px;
		}

		.comentario {
			background: white;
			border: 1px solid #dee2e6;
			border-radius: 8px;
			padding: 15px;
			margin: 10px 0;
		}

		.comentario-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 10px;
		}

		.comentario-autor {
			font-weight: bold;
			color: #333;
		}

		.comentario-data {
			font-size: 0.8em;
			color: #999;
		}

		.modal-footer {
			padding: 20px 25px;
			border-top: 1px solid #dee2e6;
			text-align: right;
		}

		.btn {
			padding: 10px 20px;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			font-size: 0.9em;
			transition: all 0.3s ease;
			margin-left: 10px;
		}

		.btn-primary {
			background: #667eea;
			color: white;
		}

		.btn-primary:hover {
			background: #5a6fd8;
		}

		.btn-secondary {
			background: #6c757d;
			color: white;
		}

		.btn-secondary:hover {
			background: #5a6268;
		}

		@media (max-width: 1200px) {
			.periodos-container {
				flex-direction: column;
				gap: 20px;
			}
			
			.periodo {
				min-width: auto;
			}
			
			.legenda {
				position: static;
				margin: 20px auto;
				max-width: 400px;
			}
		}
	</style>
</head>
<body>
	<div class="header">
		<a href="index.html" class="nav-link">← Voltar ao Início</a>
		<h1>Mapa Curricular - Engenharia de Software</h1>
		
		<div class="controles">
			<button onclick="resetarMapa()">Resetar Mapa</button>
			<button onclick="simularProgresso()">Simular Progresso</button>
		</div>
	</div>

	<div class="legenda">
		<h4>Status das Matérias</h4>
		<div class="legenda-item">
			<div class="legenda-cor" style="background: #6c757d;"></div>
			<span>Indisponível</span>
		</div>
		<div class="legenda-item">
			<div class="legenda-cor" style="background: #adb5bd;"></div>
			<span>Disponível</span>
		</div>
		<div class="legenda-item">
			<div class="legenda-cor" style="background: #a8dadc;"></div>
			<span>Cursada</span>
		</div>
		<div class="legenda-item">
			<div class="legenda-cor" style="background: #52c41a;"></div>
			<span>Avaliada</span>
		</div>
		<div style="margin-top: 15px; font-size: 0.8em; color: #666;">
			Clique nas matérias para alterar o status
		</div>
	</div>

	<div class="info-materia" id="infoMateria">
		<h4 id="infoTitulo"></h4>
		<p id="infoDescricao"></p>
		<div id="infoPreRequisitos"></div>
	</div>

	<!-- Modal da Disciplina -->
	<div id="modalDisciplina" class="modal">
		<div class="modal-content">
			<div class="modal-header">
				<span class="close">&times;</span>
				<h2 id="modalTitulo">Cálculo I</h2>
				<div class="codigo" id="modalCodigo">MAT001</div>
			</div>
			<div class="modal-body">
				<div class="info-section">
					<h3>Informações Gerais</h3>
					<p><strong>Carga Horária:</strong> <span id="modalCargaHoraria">60 horas</span></p>
					<p><strong>Créditos:</strong> <span id="modalCreditos">4</span></p>
					<p><strong>Período:</strong> <span id="modalPeriodo">1º</span></p>
					<p><strong>Ementa:</strong></p>
					<p id="modalEmenta">Funções de uma variável real, limites, continuidade, derivadas e suas aplicações, integrais definidas e indefinidas.</p>
				</div>

				<div class="info-section">
					<h3>Professores</h3>
					<div id="professoresContainer">
						<div class="professor-card">
							<h4>Dr. João Silva</h4>
							<div class="contato">Email: joao.silva@universidade.edu.br</div>
							<div class="contato">Sala: 305 - Bloco A</div>
						</div>
						<div class="professor-card">
							<h4>Dra. Maria Santos</h4>
							<div class="contato">Email: maria.santos@universidade.edu.br</div>
							<div class="contato">Sala: 201 - Bloco B</div>
						</div>
					</div>
				</div>

				<div class="status-section">
					<h3>Status da Disciplina</h3>
					<div class="status-controls">
						<div class="status-btn" data-status="1" onclick="alterarStatusModal(1)">Não Cursada</div>
						<div class="status-btn" data-status="2" onclick="alterarStatusModal(2)">Cursada</div>
						<div class="status-btn" data-status="3" onclick="alterarStatusModal(3)">Avaliada</div>
					</div>

					<div class="avaliacao-container" id="avaliacaoContainer">
						<div class="form-group">
							<label for="notaDisciplina">Nota da Disciplina:</label>
							<select id="notaDisciplina" onchange="salvarAvaliacao()">
								<option value="">Selecione a nota da disciplina</option>
								<option value="10">10 - Excelente</option>
								<option value="9">9 - Muito Bom</option>
								<option value="8">8 - Bom</option>
								<option value="7">7 - Regular</option>
								<option value="6">6 - Suficiente</option>
								<option value="5">5 - Insuficiente</option>
								<option value="4">4 - Ruim</option>
								<option value="3">3 - Muito Ruim</option>
								<option value="2">2 - Péssimo</option>
								<option value="1">1 - Reprovado</option>
							</select>
						</div>

						<div class="form-group">
							<label for="professorAvaliado">Professor Cursado:</label>
							<select id="professorAvaliado" onchange="salvarAvaliacao()">
								<option value="">Selecione o professor</option>
								<option value="joao-silva">Dr. João Silva</option>
								<option value="maria-santos">Dra. Maria Santos</option>
							</select>
						</div>

						<div class="form-group" id="notaProfessorGroup" style="display: none;">
							<label for="notaProfessor">Nota do Professor:</label>
							<select id="notaProfessor" onchange="salvarAvaliacao()">
								<option value="">Avalie o professor</option>
								<option value="10">10 - Excelente Didática</option>
								<option value="9">9 - Muito Boa Didática</option>
								<option value="8">8 - Boa Didática</option>
								<option value="7">7 - Didática Regular</option>
								<option value="6">6 - Didática Suficiente</option>
								<option value="5">5 - Didática Insuficiente</option>
								<option value="4">4 - Didática Ruim</option>
								<option value="3">3 - Didática Muito Ruim</option>
								<option value="2">2 - Didática Péssima</option>
								<option value="1">1 - Didática Inadequada</option>
							</select>
						</div>

						<div class="form-group">
							<label for="comentarioAvaliacao">Comentário sobre a Disciplina:</label>
							<textarea id="comentarioAvaliacao" placeholder="Como foi sua experiência com esta disciplina? Conteúdo, dificuldade, relevância..." onchange="salvarAvaliacao()"></textarea>
						</div>

						<div class="form-group" id="comentarioProfessorGroup" style="display: none;">
							<label for="comentarioProfessor">Comentário sobre o Professor:</label>
							<textarea id="comentarioProfessor" placeholder="Como foi a didática do professor? Metodologia, clareza, disponibilidade..." onchange="salvarAvaliacao()"></textarea>
						</div>
					</div>
				</div>

				<div class="comentarios-section">
					<h3>Comentários de Outros Alunos</h3>
					<div id="comentariosLista">
						<div class="comentario">
							<div class="comentario-header">
								<span class="comentario-autor">Ana Silva</span>
								<span class="comentario-data">15/03/2024</span>
							</div>
							<p><strong>Disciplina:</strong> Disciplina fundamental! Recomendo fazer muitos exercícios de derivadas.</p>
							<p><strong>Professor (Dr. João Silva):</strong> Explica muito bem os conceitos e está sempre disponível para dúvidas.</p>
							<div class="nota-display">Disciplina: 9</div>
							<div class="nota-display" style="background: #667eea;">Professor: 10</div>
						</div>
						<div class="comentario">
							<div class="comentario-header">
								<span class="comentario-autor">Carlos Mendes</span>
								<span class="comentario-data">20/02/2024</span>
							</div>
							<p><strong>Disciplina:</strong> Matéria desafiadora, mas essencial para o curso. Dediquem tempo aos estudos!</p>
							<p><strong>Professor (Dra. Maria Santos):</strong> Muito didática e organizada. Aulas bem estruturadas.</p>
							<div class="nota-display">Disciplina: 8</div>
							<div class="nota-display" style="background: #667eea;">Professor: 9</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button class="btn btn-secondary" onclick="fecharModal()">Fechar</button>
				<button class="btn btn-primary" onclick="salvarEFechar()">Salvar e Fechar</button>
			</div>
		</div>
	</div>

	<div class="mapa-container">
		<div class="periodos-container" id="periodosContainer">
			<!-- 1º Período -->
			<div class="periodo">
				<h3>1º Período</h3>
				<div class="materia disponivel" data-id="calculo1" data-prereq="">
					Cálculo I
				</div>
				<div class="materia disponivel" data-id="algoritmos" data-prereq="">
					Algoritmos e Programação
				</div>
				<div class="materia disponivel" data-id="intro-eng" data-prereq="">
					Introdução à Engenharia
				</div>
				<div class="materia disponivel" data-id="comunicacao" data-prereq="">
					Comunicação e Expressão
				</div>
			</div>

			<!-- 2º Período -->
			<div class="periodo">
				<h3>2º Período</h3>
				<div class="materia indisponivel" data-id="calculo2" data-prereq="calculo1">
					Cálculo II
				</div>
				<div class="materia indisponivel" data-id="estruturas-dados" data-prereq="algoritmos">
					Estruturas de Dados
				</div>
				<div class="materia indisponivel" data-id="poo" data-prereq="algoritmos">
					Programação Orientada a Objetos
				</div>
				<div class="materia indisponivel" data-id="algebra-linear" data-prereq="calculo1">
					Álgebra Linear
				</div>
			</div>

			<!-- 3º Período -->
			<div class="periodo">
				<h3>3º Período</h3>
				<div class="materia indisponivel" data-id="estatistica" data-prereq="calculo2">
					Estatística
				</div>
				<div class="materia indisponivel" data-id="banco-dados" data-prereq="estruturas-dados">
					Banco de Dados
				</div>
				<div class="materia indisponivel" data-id="requisitos" data-prereq="intro-eng">
					Engenharia de Requisitos
				</div>
				<div class="materia indisponivel" data-id="arquitetura-computadores" data-prereq="poo">
					Arquitetura de Computadores
				</div>
			</div>

			<!-- 4º Período -->
			<div class="periodo">
				<h3>4º Período</h3>
				<div class="materia indisponivel" data-id="analise-sistemas" data-prereq="requisitos">
					Análise de Sistemas
				</div>
				<div class="materia indisponivel" data-id="desenvolvimento-web" data-prereq="banco-dados,poo">
					Desenvolvimento Web
				</div>
				<div class="materia indisponivel" data-id="metodologias" data-prereq="requisitos">
					Metodologias Ágeis
				</div>
				<div class="materia indisponivel" data-id="pesquisa-operacional" data-prereq="estatistica,algebra-linear">
					Pesquisa Operacional
				</div>
			</div>

			<!-- 5º Período -->
			<div class="periodo">
				<h3>5º Período</h3>
				<div class="materia indisponivel" data-id="arquitetura-software" data-prereq="analise-sistemas,desenvolvimento-web">
					Arquitetura de Software
				</div>
				<div class="materia indisponivel" data-id="programacao-mobile" data-prereq="desenvolvimento-web">
					Programação Mobile
				</div>
				<div class="materia indisponivel" data-id="qualidade-software" data-prereq="metodologias">
					Qualidade de Software
				</div>
				<div class="materia indisponivel" data-id="gestao-projetos" data-prereq="metodologias">
					Gestão de Projetos
				</div>
			</div>

			<!-- 6º Período -->
			<div class="periodo">
				<h3>6º Período</h3>
				<div class="materia indisponivel" data-id="testes-software" data-prereq="qualidade-software">
					Testes de Software
				</div>
				<div class="materia indisponivel" data-id="sistemas-distribuidos" data-prereq="arquitetura-software">
					Sistemas Distribuídos
				</div>
				<div class="materia indisponivel" data-id="empreendedorismo" data-prereq="gestao-projetos">
					Empreendedorismo
				</div>
				<div class="materia indisponivel" data-id="etica" data-prereq="">
					Ética Profissional
				</div>
			</div>

			<!-- 7º Período -->
			<div class="periodo">
				<h3>7º Período</h3>
				<div class="materia indisponivel" data-id="seguranca" data-prereq="sistemas-distribuidos">
					Segurança da Informação
				</div>
				<div class="materia indisponivel" data-id="inteligencia-artificial" data-prereq="estruturas-dados,estatistica">
					Inteligência Artificial
				</div>
				<div class="materia indisponivel" data-id="economia" data-prereq="">
					Economia
				</div>
				<div class="materia indisponivel" data-id="optativa1" data-prereq="">
					Optativa I
				</div>
			</div>

			<!-- 8º Período -->
			<div class="periodo">
				<h3>8º Período</h3>
				<div class="materia indisponivel" data-id="tcc1" data-prereq="gestao-projetos">
					TCC I
				</div>
				<div class="materia indisponivel" data-id="optativa2" data-prereq="">
					Optativa II
				</div>
				<div class="materia indisponivel" data-id="estagio" data-prereq="testes-software">
					Estágio Supervisionado
				</div>
			</div>

			<!-- 9º Período -->
			<div class="periodo">
				<h3>9º Período</h3>
				<div class="materia indisponivel" data-id="tcc2" data-prereq="tcc1">
					TCC II
				</div>
				<div class="materia indisponivel" data-id="optativa3" data-prereq="">
					Optativa III
				</div>
			</div>
		</div>
	</div>

	<script>
		// Estado das matérias: 0=indisponível, 1=disponível, 2=cursada, 3=avaliada
		let estadoMaterias = {};
		
		// Dados das matérias
		const materiasInfo = {
			'calculo1': { 
				nome: 'Cálculo I', 
				codigo: 'MAT001',
				creditos: 4,
				cargaHoraria: '60 horas',
				periodo: '1º',
				ementa: 'Funções de uma variável real, limites, continuidade, derivadas e suas aplicações, integrais definidas e indefinidas.',
				descricao: 'Fundamentos do cálculo diferencial e integral',
				professores: [
					{ nome: 'Dr. João Silva', email: 'joao.silva@universidade.edu.br', sala: '305 - Bloco A' },
					{ nome: 'Dra. Maria Santos', email: 'maria.santos@universidade.edu.br', sala: '201 - Bloco B' }
				]
			},
			'algoritmos': { nome: 'Algoritmos e Programação', descricao: 'Introdução à lógica de programação e algoritmos' },
			'intro-eng': { nome: 'Introdução à Engenharia', descricao: 'Conceitos básicos da engenharia de software' },
			'comunicacao': { nome: 'Comunicação e Expressão', descricao: 'Desenvolvimento de habilidades de comunicação' },
			// Adicione mais informações conforme necessário
		};

		// Dados salvos das avaliações
		let avaliacoesSalvas = {};

		document.addEventListener('DOMContentLoaded', function() {
			inicializarMapa();
			adicionarEventListeners();
			configurarModal();
		});

		function configurarModal() {
			const modal = document.getElementById('modalDisciplina');
			const closeBtn = document.querySelector('.close');

			// Fechar modal ao clicar no X
			closeBtn.onclick = function() {
				fecharModal();
			}

			// Fechar modal ao clicar fora dele
			window.onclick = function(event) {
				if (event.target == modal) {
					fecharModal();
				}
			}
		}

		function inicializarMapa() {
			const materias = document.querySelectorAll('.materia');
			materias.forEach(materia => {
				const id = materia.dataset.id;
				// Inicializar com o estado atual baseado na classe
				if (materia.classList.contains('disponivel')) {
					estadoMaterias[id] = 1;
				} else {
					estadoMaterias[id] = 0;
				}
			});
			
			atualizarDisponibilidade();
		}

		function adicionarEventListeners() {
			const materias = document.querySelectorAll('.materia');
			materias.forEach(materia => {
				materia.addEventListener('click', function(e) {
					const disciplinaId = this.dataset.id;
					
					// Se for Cálculo I, abrir modal
					if (disciplinaId === 'calculo1') {
						abrirModal(disciplinaId);
					} else {
						// Comportamento normal para outras matérias
						if (!this.classList.contains('indisponivel')) {
							alterarStatusMateria(this);
						}
					}
				});

				materia.addEventListener('mouseenter', function() {
					mostrarInfoMateria(this);
				});

				materia.addEventListener('mouseleave', function() {
					esconderInfoMateria();
				});
			});

			// Adicionar listener para mostrar/esconder campos do professor
			document.getElementById('professorAvaliado').addEventListener('change', function() {
				const professorSelecionado = this.value;
				const notaProfessorGroup = document.getElementById('notaProfessorGroup');
				const comentarioProfessorGroup = document.getElementById('comentarioProfessorGroup');
				
				if (professorSelecionado) {
					notaProfessorGroup.style.display = 'block';
					comentarioProfessorGroup.style.display = 'block';
				} else {
					notaProfessorGroup.style.display = 'none';
					comentarioProfessorGroup.style.display = 'none';
					// Limpar campos quando professor não está selecionado
					document.getElementById('notaProfessor').value = '';
					document.getElementById('comentarioProfessor').value = '';
				}
			});
		}

		function abrirModal(disciplinaId) {
			const disciplina = materiasInfo[disciplinaId];
			if (!disciplina) return;

			const modal = document.getElementById('modalDisciplina');
			
			// Preencher informações do modal
			document.getElementById('modalTitulo').textContent = disciplina.nome;
			document.getElementById('modalCodigo').textContent = disciplina.codigo || '';
			document.getElementById('modalCargaHoraria').textContent = disciplina.cargaHoraria || '';
			document.getElementById('modalCreditos').textContent = disciplina.creditos || '';
			document.getElementById('modalPeriodo').textContent = disciplina.periodo || '';
			document.getElementById('modalEmenta').textContent = disciplina.ementa || '';

			// Atualizar status atual
			atualizarStatusModal(disciplinaId);
			
			// Carregar avaliação salva se existir
			carregarAvaliacaoSalva(disciplinaId);

			modal.style.display = 'block';
		}

		function fecharModal() {
			document.getElementById('modalDisciplina').style.display = 'none';
		}

		function atualizarStatusModal(disciplinaId) {
			const statusAtual = estadoMaterias[disciplinaId] || 1;
			const statusBtns = document.querySelectorAll('.status-btn');
			
			statusBtns.forEach(btn => {
				btn.classList.remove('active');
				if (parseInt(btn.dataset.status) === statusAtual) {
					btn.classList.add('active');
				}
			});

			// Mostrar/esconder container de avaliação
			const avaliacaoContainer = document.getElementById('avaliacaoContainer');
			if (statusAtual === 3) {
				avaliacaoContainer.classList.add('show');
			} else {
				avaliacaoContainer.classList.remove('show');
			}
		}

		function alterarStatusModal(novoStatus) {
			const disciplinaId = 'calculo1';
			estadoMaterias[disciplinaId] = novoStatus;
			
			// Atualizar visual do mapa
			const elemento = document.querySelector(`[data-id="${disciplinaId}"]`);
			atualizarVisualMateria(elemento, novoStatus);
			
			// Atualizar modal
			atualizarStatusModal(disciplinaId);
			
			// Atualizar disponibilidade de outras matérias
			atualizarDisponibilidade();
		}

		function salvarAvaliacao() {
			const disciplinaId = 'calculo1';
			const notaDisciplina = document.getElementById('notaDisciplina').value;
			const comentarioAvaliacao = document.getElementById('comentarioAvaliacao').value;
			const professor = document.getElementById('professorAvaliado').value;
			const notaProfessor = document.getElementById('notaProfessor').value;
			const comentarioProfessor = document.getElementById('comentarioProfessor').value;

			// Salvar dados localmente
			avaliacoesSalvas[disciplinaId] = {
				notaDisciplina: notaDisciplina,
				comentario: comentarioAvaliacao,
				professor: professor,
				notaProfessor: notaProfessor,
				comentarioProfessor: comentarioProfessor,
				data: new Date().toLocaleDateString('pt-BR')
			};

			// Se há nota da disciplina ou comentário, marcar como avaliada
			if (notaDisciplina || comentarioAvaliacao) {
				alterarStatusModal(3);
			}
		}

		function carregarAvaliacaoSalva(disciplinaId) {
			const avaliacao = avaliacoesSalvas[disciplinaId];
			if (avaliacao) {
				document.getElementById('notaDisciplina').value = avaliacao.notaDisciplina || '';
				document.getElementById('comentarioAvaliacao').value = avaliacao.comentario || '';
				document.getElementById('professorAvaliado').value = avaliacao.professor || '';
				document.getElementById('notaProfessor').value = avaliacao.notaProfessor || '';
				document.getElementById('comentarioProfessor').value = avaliacao.comentarioProfessor || '';
				
				// Mostrar campos do professor se houver professor selecionado
				const professorSelecionado = avaliacao.professor;
				const notaProfessorGroup = document.getElementById('notaProfessorGroup');
				const comentarioProfessorGroup = document.getElementById('comentarioProfessorGroup');
				
				if (professorSelecionado) {
					notaProfessorGroup.style.display = 'block';
					comentarioProfessorGroup.style.display = 'block';
				} else {
					notaProfessorGroup.style.display = 'none';
					comentarioProfessorGroup.style.display = 'none';
				}
			} else {
				// Limpar todos os campos
				document.getElementById('notaDisciplina').value = '';
				document.getElementById('comentarioAvaliacao').value = '';
				document.getElementById('professorAvaliado').value = '';
				document.getElementById('notaProfessor').value = '';
				document.getElementById('comentarioProfessor').value = '';
				
				// Esconder campos do professor
				document.getElementById('notaProfessorGroup').style.display = 'none';
				document.getElementById('comentarioProfessorGroup').style.display = 'none';
			}
		}

		function salvarEFechar() {
			salvarAvaliacao();
			fecharModal();
		}

		function alterarStatusMateria(elemento) {
			const id = elemento.dataset.id;
			const estadoAtual = estadoMaterias[id];
			
			// Ciclo: disponível -> cursada -> avaliada -> disponível
			let novoEstado;
			if (estadoAtual === 1) novoEstado = 2; // disponível -> cursada
			else if (estadoAtual === 2) novoEstado = 3; // cursada -> avaliada
			else if (estadoAtual === 3) novoEstado = 1; // avaliada -> disponível
			else novoEstado = 1; // fallback para disponível

			estadoMaterias[id] = novoEstado;
			atualizarVisualMateria(elemento, novoEstado);
			atualizarDisponibilidade();
		}

		function atualizarVisualMateria(elemento, estado) {
			elemento.className = 'materia';
			switch(estado) {
				case 0:
					elemento.classList.add('indisponivel');
					break;
				case 1:
					elemento.classList.add('disponivel');
					break;
				case 2:
					elemento.classList.add('cursada');
					break;
				case 3:
					elemento.classList.add('avaliada');
					break;
			}
		}

		function atualizarDisponibilidade() {
			const materias = document.querySelectorAll('.materia');
			
			materias.forEach(materia => {
				const id = materia.dataset.id;
				const preRequisitos = materia.dataset.prereq.split(',').filter(p => p.trim());
				
				if (estadoMaterias[id] >= 2) return; // Já cursada ou avaliada, não muda

				let podeSerCursada = true;
				if (preRequisitos.length > 0) {
					podeSerCursada = preRequisitos.every(preReq => {
						return estadoMaterias[preReq.trim()] >= 2; // Cursada ou avaliada
					});
				}

				if (podeSerCursada && estadoMaterias[id] === 0) {
					estadoMaterias[id] = 1;
					atualizarVisualMateria(materia, 1);
				} else if (!podeSerCursada && estadoMaterias[id] === 1) {
					estadoMaterias[id] = 0;
					atualizarVisualMateria(materia, 0);
				}
			});
		}

		function mostrarInfoMateria(elemento) {
			const id = elemento.dataset.id;
			const info = materiasInfo[id];
			const preRequisitos = elemento.dataset.prereq.split(',').filter(p => p.trim());
			
			const infoDiv = document.getElementById('infoMateria');
			const titulo = document.getElementById('infoTitulo');
			const descricao = document.getElementById('infoDescricao');
			const preReqDiv = document.getElementById('infoPreRequisitos');

			titulo.textContent = info ? info.nome : elemento.textContent.trim();
			
			if (id === 'calculo1') {
				descricao.textContent = 'Clique para ver detalhes e avaliar';
			} else {
				descricao.textContent = info ? info.descricao : 'Clique para alterar o status';
			}
			
			if (preRequisitos.length > 0) {
				preReqDiv.innerHTML = '<strong>Pré-requisitos:</strong><br>' + 
					preRequisitos.map(p => p.trim()).join(', ');
			} else {
				preReqDiv.innerHTML = '<strong>Sem pré-requisitos</strong>';
			}

			infoDiv.style.display = 'block';
		}

		function esconderInfoMateria() {
			document.getElementById('infoMateria').style.display = 'none';
		}

		function resetarMapa() {
			const materias = document.querySelectorAll('.materia');
			materias.forEach(materia => {
				const id = materia.dataset.id;
				const preRequisitos = materia.dataset.prereq.split(',').filter(p => p.trim());
				
				// Matérias sem pré-requisitos ficam disponíveis
				if (preRequisitos.length === 0) {
					estadoMaterias[id] = 1;
					atualizarVisualMateria(materia, 1);
				} else {
					estadoMaterias[id] = 0;
					atualizarVisualMateria(materia, 0);
				}
			});
			
			// Limpar avaliações salvas
			avaliacoesSalvas = {};
		}

		function simularProgresso() {
			// Simula um aluno no 4º período
			const materiasParaCursar = [
				'calculo1', 'algoritmos', 'intro-eng', 'comunicacao',
				'calculo2', 'estruturas-dados', 'poo', 'algebra-linear',
				'estatistica', 'banco-dados', 'requisitos'
			];

			materiasParaCursar.forEach(id => {
				const materia = document.querySelector(`[data-id="${id}"]`);
				if (materia) {
					estadoMaterias[id] = Math.random() > 0.5 ? 3 : 2; // Cursada ou avaliada aleatoriamente
					atualizarVisualMateria(materia, estadoMaterias[id]);
				}
			});

			atualizarDisponibilidade();
		}
	</script>
</body>
</html>